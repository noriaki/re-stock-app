# Re-Stock アプリ アクティブコンテキスト

## 現在の作業の焦点

現在、Re-Stock アプリの初期開発フェーズにあり、以下の作業に焦点を当てています：

**最優先タスク: 在庫操作UI実装**
- アイテムに対する在庫操作UIを実装する
- スワイプ操作でアクションパネルを表示する設計
- よく使う操作（開封済み消費、未開封→開封移行）のショートカットボタン配置
- 詳細な数量調整用のパネル設計

1. **プロジェクト構造の確立**

   - ✅ ディレクトリ構造の設計と実装
   - ✅ 基本的なファイル構成の作成
   - ✅ 開発環境の構築

2. **ドメインモデルの設計と実装**

   - ✅ エンティティと値オブジェクトの定義
   - ✅ ドメインサービスの特定と実装
   - ⬜ リポジトリインターフェースの設計と実装
   - ⬜ 詳細なバリデーションロジックの実装

3. **UI コンポーネントの実装**

   - ✅ 基本的な UI コンポーネントの実装（Badge, Button）
   - ✅ 機能コンポーネントの実装（Header, NavigationBar, CategoryCard, ItemCard）
   - ✅ メインアプリケーションコンポーネントの実装（InventoryApp）
   - ⬜ アイテム追加/編集フォームの実装
   - ⬜ 詳細ページの実装

4. **状態管理の実装**
   - ✅ Zustand ストアの設計と実装
   - ✅ アイテムストアの実装
   - ✅ カテゴリ表示のための派生データ実装
   - ✅ localStorage との連携
   - ✅ 状態更新ロジックの実装
   - ⬜ フィルタリング機能の強化

## 最近の変更

以下の作業が完了しています：

1. **プロジェクト初期化と設定**

   - ✅ Next.js プロジェクトの作成
   - ✅ TypeScript の設定
   - ✅ ESLint と Prettier の設定
   - ✅ Tailwind CSS の設定

2. **依存関係の追加**

   - ✅ コア依存関係のインストール
   - ✅ 開発依存関係のインストール
   - ✅ Zustand, lucide-react, class-variance-authority, clsx, tailwind-merge のインストール

3. **ドメインモデルの実装**

   - ✅ ブランド型を使用した型安全な値オブジェクト（ItemId, ItemName, CategoryName, BrandName）
   - ✅ エンティティ（Item）の定義
   - ✅ ドメインサービス（isItemLowStock, getLowStockItems）の実装

4. **状態管理の実装**

   - ✅ Zustand ストアの実装（useItemStore）
   - ✅ localStorage を使用した永続化
   - ✅ サンプルデータの初期化
   - ✅ 在庫操作のためのアクション実装

5. **UI コンポーネントの実装**

   - ✅ 基本 UI コンポーネント（Badge, Button）の実装
   - ✅ ヘッダーとナビゲーションバーの実装
   - ✅ カテゴリカードの実装
   - ✅ アイテムカードの実装
   - ✅ メインアプリケーションコンポーネントの実装

6. **コードのコミット**
   - ✅ プロジェクト構造と Tailwind 設定の追加
   - ✅ ドメインモデルの実装
   - ✅ Zustand を使用した状態管理の実装
   - ✅ 基本 UI コンポーネントの実装
   - ✅ 機能コンポーネントの実装
   - ✅ メインアプリケーションコンポーネントの実装
   - ✅ 依存関係の更新

## 次のステップ

短期的には、以下のタスクに取り組む予定です（優先順位順）：

1. **在庫操作UI実装** (最優先)
   - ItemCardコンポーネントの拡張またはラッパー作成
   - 操作パネルのデザイン・実装
   - Zustandストアとの連携

2. **アイテム追加/編集フォームの実装**

   - モーダルまたは専用ページとしての実装
   - フォームバリデーションの実装
   - 画像アップロード機能の検討

3. **カテゴリフィルターの実装**

   - カテゴリ別表示切り替え
   - 検索機能

4. **リポジトリの完全実装**

   - リポジトリインターフェースの完全実装
   - LocalStorageItemRepository の完全実装
   - InMemoryItemRepository の実装（テスト用）

5. **バリデーションの強化**

   - 入力値の詳細なバリデーション
   - エラーメッセージの国際化対応
   - フォームバリデーションの実装

6. **テストの実装**
   - ドメインモデルのユニットテスト
   - リポジトリのユニットテスト
   - UI コンポーネントのテスト
   - 統合テスト

## アクティブな決定事項と考慮事項

### 決定済み事項

1. **アーキテクチャ**

   - クリーンアーキテクチャとドメイン駆動設計の採用
   - レイヤー間の依存関係の方向性

2. **技術スタック**

   - Next.js (App Router) の採用
   - TypeScript の採用
   - Tailwind CSS の採用
   - Zustand の採用
   - localStorage の採用（初期実装）

3. **UI デザイン**

   - モバイルファーストのレイアウト
   - カテゴリごとの商品表示
   - 未開封品と開封済み品の視覚的な区別（緑と黄色の丸）
   - 在庫が閾値以下の商品に警告バッジ表示
   - 在庫操作UIはスワイプ方式を採用し、よく使う操作パターンをショートカットとして提供
   - 操作パターンは主に「未開封→開封移行」「開封済み消費」「新規購入」を優先的にサポート
   - 複合操作（開封と同時に使い切るなど）も考慮したUI設計を実装

4. **開発プロセス**
   - GitHub Flow に基づくブランチ戦略
   - 意味のある単位でのコミット
   - 機能ごとの優先順位付け

### 検討中の事項

1. **データモデルの詳細設計**

   - カテゴリの事前定義 vs. ユーザー定義
   - アイテムの追加属性（例：サイズ、色、購入日など）
   - 複数の購入 URL の対応

2. **UI/UX の詳細設計**

   - ダークモード対応
   - アクセシビリティ対応
   - アニメーションの追加

3. **将来的な拡張**
   - バックエンド統合の方法
   - ユーザー認証の実装
   - データ同期の方法

## 現在の課題

1. **技術的な課題**

   - Tailwind CSS v4 との互換性（@apply ディレクティブの変更など）
   - サーバーコンポーネントと Zustand の連携（"use client" ディレクティブの必要性）
   - localStorage の容量制限への対応

2. **ビジネス的な課題**
   - ユーザーニーズの優先順位付け
   - MVP（最小実行可能製品）の範囲の決定
   - フィードバックの収集方法

## 進行中のタスク

- UI コンポーネントの拡張
- アイテム操作機能の実装
- バリデーションロジックの強化

## 今後の検討事項

- ユーザーテストの計画
- デプロイ戦略の検討
- パフォーマンスモニタリングの導入
- アナリティクスの導入
